# run_on_gpu
## This is a test scripts for benchmarking difference between running python code on GPU and CPU

For CPU these libs are used
* pandas
* numpy
* time
* math

For GPU these libs are used
* rapids https://rapids.ai/
* math
* numpy
* time
* numba

Basically both script does the same thing:
1) Creates dataframe made of 1 million rows of lat1, lat2, lon1, lon2
2) Calculate the Haversine distance
3) Append the output to another column for all row

Benchmark on CPU:
```
             lat1       lon1       lat2       lon2         out
0       10.472986  10.232104   8.641496  10.356747  204.110381
1        9.318574   9.753226  11.775283  10.089339  275.633061
2       10.242439  10.776382   8.415800  11.014712  204.789346
3        8.299264  11.345076  11.332976  10.688445  344.918161
4       10.753143   8.609575   9.758592   9.551190  151.145004
5        8.465279   8.760826  10.789511   8.254360  264.338941
6       10.005127   9.721079  11.462821  12.725711  366.081781
7        9.879772  10.542282  11.955421  10.527217  230.807497
8        9.193018  11.356225  11.230383   9.527697  302.255952
9       12.871819  11.272174   9.608823  12.437866  384.450798
10       9.402177   9.272150  10.667725  10.554156  198.761479
11      10.472457   9.578737   9.346777   9.159099  133.342648
12      11.095956   8.902985   8.825604  10.176351  288.404926
13       8.784831   9.633924   9.694733  10.129976  114.893978
14      11.342356   9.880957  10.544192   9.216332  114.636800
15       9.877850  10.425037   8.713979  10.931886  140.861630
16      11.012515  10.294249   9.113205  10.771389  217.557887
17       9.086131   9.264981  10.422715  10.569180  206.190398
18       8.970470   9.124035  10.519462  10.323883  216.692400
19      11.209796   8.708588  10.496643   8.583900   80.459636
20      10.501872   8.373133  10.748021   8.662083   41.789607
21      10.138846  11.295782   9.564168   9.940151  161.679669
22      10.640761   9.254434   8.664684   9.858916  229.502843
23      10.527333  10.938943   9.304323  10.253639  155.332909
24       8.845640   9.935272  11.060471  10.856645  266.147082
25       7.786667  10.073033  11.070383   9.439452  371.686072
26       8.318243   9.362465  11.026111  10.324434  319.027290
27       8.211906  10.223418  12.013872  11.716272  453.233232
28       7.781465  10.346157  10.193437  11.615620  302.269598
29       9.352569  10.531871   8.752955  10.775719   71.850062
...           ...        ...        ...        ...         ...
999970  10.016263   9.811747  10.429259   9.014388   98.601651
999971  10.046433  11.447656   9.911914  11.220546   29.022827
999972  10.690165  10.892910   9.653415  10.223779  136.575743
999973  10.017350  10.956520   9.702211   9.967981  113.825012
999974  10.385985  10.465210  11.413262  10.370974  114.690475
999975  10.237702  11.178477  10.242468  11.735493   60.953081
999976  11.590090  10.281934  10.077759   9.042646  215.862066
999977  10.627454  10.674768   8.110365  10.827989  280.391800
999978   9.052323   9.912182  11.283378  11.030163  276.613355
999979   9.802756   9.244163   9.168702  10.032898  111.595814
999980   9.590608  10.717315   9.610877   8.884450  200.963172
999981   8.806735  11.548766  10.275468   9.376912  288.769681
999982   9.616851   8.979908   9.817782   9.860289   99.042359
999983  11.085607   9.641793  10.453146   9.479306   72.531680
999984   9.891807  10.409937  11.742256   9.933456  212.239039
999985  10.449802  10.386187   9.729502   9.498806  125.905754
999986   9.370498   8.533213   8.707491  10.689980  248.050432
999987  10.471565   8.559485   9.366191  10.269768  224.052269
999988  10.715566   9.672852   8.608502  11.224236  289.500459
999989   9.860639   9.995151  10.462239   9.677258   75.402337
999990  11.016489  10.022706  10.723360  11.295443  142.753292
999991   9.132385   9.439353  10.537745  11.030641  234.123077
999992  10.426456  11.818947   9.223545   9.867354  252.210412
999993   8.549211   8.920173  10.178864  10.580814  256.961070
999994  10.686335   8.660611   8.200200  10.910390  370.552228
999995   8.802334  11.814816   9.339203   9.894336  219.162958
999996   9.177757   9.635044   8.957800  10.210969   67.804428
999997   9.941079   8.522923   9.320982  11.388289  321.599560
999998  10.189983  11.302052   9.292642  10.202894  156.415884
999999   8.296236  11.064927   9.610030   8.124515  354.470010

[1000000 rows x 5 columns]
Time taken is 65.42767930030823
```
Here is the test on GPU:
```
thread_id: 23 bid: 0 array size: 2 block threads: 64
thread_id: 24 bid: 0 array size: 2 block threads: 64
thread_id: 25 bid: 0 array size: 2 block threads: 64
thread_id: 26 bid: 0 array size: 2 block threads: 64
thread_id: 27 bid: 0 array size: 2 block threads: 64
thread_id: 28 bid: 0 array size: 2 block threads: 64
thread_id: 29 bid: 0 array size: 2 block threads: 64
thread_id: 30 bid: 0 array size: 2 block threads: 64
thread_id: 31 bid: 0 array size: 2 block threads: 64
                  lat1                lon1                lat2                lon2                 out
0  10.472985831489979  11.889149236424382  10.173868999704066   9.557544882003544   257.2241270903516
1   9.318574120560555  11.733838880199368  10.237408418960612  10.941703071688115  134.06359643450295
2  10.242439496690478   9.969705766548733   8.158691857367202   8.084420608064908   310.6504166817936
3   8.299264365961669   10.28430047739249  10.376267158128183   9.831747409666285   236.2291524258287
4    10.7531428339492  11.003470626251172   9.416266513336655  12.702623243748901  238.11529748873042
5   8.465278659791956   8.336523314928591   9.556516731957236   9.756561925536149  197.59490753039952
6  10.005127078132272   9.812600393162109   8.784379218977694   10.12066104871133  139.88455181503696
7   9.879772329843808  10.467652512664458   9.813979233420577  10.789244597839508   35.98414215552911
8   9.193018121427048  10.546449610519359  10.651736707945044  11.838728049905953  215.27523400275786
9  12.871819394988917  10.523580879934386  10.876002468581849    8.18737264927275  337.44421611873196
[999990 more rows]
Time Taken is 3.6753339767456055
```
# From 65 second on CPU to 3.7 second on GPU. Amazing!
